<head>
  <style>
    body {
      margin: 0;
    }
  </style>

  <script src="//unpkg.com/globe.gl"></script>
  <!--<script src="../../dist/globe.gl.js"></script>-->
</head>

<body>
  <div id="globeViz"></div>

  <script>
    fetch("./datasets/ne_110m_admin_0_countries.geojson")
      .then((res) => res.json())
      .then((countries) => {
        const world = Globe()
          .globeImageUrl("//unpkg.com/three-globe/example/img/earth-dark.jpg")
          .hexBinPointsData(countries.features)
          .hexPolygonsData(countries.features)
          .hexPolygonResolution(3)
          .hexPolygonMargin(0.3)
          .hexPolygonAltitude(0.2)
          .hexPolygonColor(
            () =>
              `#${Math.round(Math.random() * Math.pow(2, 24))
                .toString(16)
                .padStart(6, "0")}`
          )
          .hexPolygonLabel(
            ({ properties: d }) => `
            <b>${d.ADMIN} (${d.ISO_A2})</b> <br />
            Population: <i>${d.POP_EST}</i>
          `
          )(document.getElementById("globeViz"));
      });
  </script>
</body>

<head>
  <style>
    body {
      margin: 0;
    }
  </style>

  <script src="//unpkg.com/d3"></script>

  <script src="//unpkg.com/globe.gl"></script>
  <!--<script src="../../dist/globe.gl.js"></script>-->
</head>

<body>
  <div id="globeViz"></div>

  <script>
    const weightColor = d3
      .scaleLinear()
      .domain([0, 60])
      .range(["lightblue", "darkred"])
      .clamp(true);

    const myGlobe = Globe()
      .globeImageUrl("//unpkg.com/three-globe/example/img/earth-night.jpg")
      .hexBinPointLat((d) => d.geometry.coordinates[1])
      .hexBinPointLng((d) => d.geometry.coordinates[0])
      .hexBinPointWeight((d) => d.properties.mag)
      .hexAltitude(({ sumWeight }) => sumWeight * 0.0025)
      .hexTopColor((d) => weightColor(d.sumWeight))
      .hexSideColor((d) => weightColor(d.sumWeight))
      .hexLabel(
        (d) => `
        <b>${d.points.length}</b> earthquakes in the past month:<ul><li>
          ${d.points
            .slice()
            .sort((a, b) => b.properties.mag - a.properties.mag)
            .map((d) => d.properties.title)
            .join("</li><li>")}
        </li></ul>
      `
      )(document.getElementById("globeViz"));

    fetch(
      "//earthquake.usgs.gov/earthquakes/feed/v1.0/summary/2.5_month.geojson"
    )
      .then((res) => res.json())
      .then((equakes) => {
        myGlobe.hexBinPointsData(equakes.features);
      });
  </script>
</body>
